<section class="notes">
  <div class="disabled-overlay"
       *ngIf="sharedService.currentApp !== 'Notes'"
       (mouseenter)="sharedService.currentApp = 'Notes'"
  ></div>
  <mat-toolbar class="w-101 notes-toolbar">
    <button mat-button [matMenuTriggerFor]="menu" class="text-light">Notes</button>
    <mat-menu #menu="matMenu">
      <ng-container *ngFor="let note of notesService.notes | async">
        <button mat-menu-item (click)="selectNote(note)">{{note.title}}</button>
      </ng-container>
    </mat-menu>
  </mat-toolbar>
  <mat-card>
    <ng-container *ngIf="notesService.selectedNoteFromService | async as note; else noNote">
      <mat-toolbar>
        <div class="toolbar">
          <h3 (click)="editTile = true" *ngIf="!editTile" matTooltip="Click to edit">{{note.title}}</h3>
          <mat-form-field *ngIf="editTile" class="mt-5">
            <input matInput type="text" placeholder="Title" [formControl]="title">
            <mat-icon matSuffix class="save-note" (click)="updateNote(note, title.value)">
              check_circle_outline
            </mat-icon>
          </mat-form-field>
          <mat-icon class="delete-note" (click)="deleteNote(note.id)">delete</mat-icon>
        </div>
      </mat-toolbar>

      <div class="note-body" (click)="editBody = true">
        <p *ngIf="!editBody" matTooltip="Click to edit">{{note.body}}</p>
        <mat-form-field *ngIf="editBody" class="w-100">
          <textarea matInput type="text" rows="6" placeholder="Body" [formControl]="body"></textarea>
        </mat-form-field>
      </div>
      <div class="w-50 ml-auto">
        <div class="note-action-row">
          <button mat-raised-button color="warn" (click)="deleteNote(note.id)">Discard Note</button>
          <button mat-raised-button color="accent" (click)="updateNote(note, note.title, body.value)">Save Note</button>
        </div>
      </div>
    </ng-container>
  </mat-card>
</section>

<ng-template #noNote>
  <div class="d-flex justify-content-center align-items-center">
    <p>Please add a new note or choose a note above to get started</p>
  </div>
</ng-template>
